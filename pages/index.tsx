import type { GetStaticProps } from 'next';
import Head from 'next/head';
import { Container, Divider, Paper, Typography } from '@mui/material';
import TimelineEntries from '../components/timeline-entries';
import { TimelineEntry } from './api/timeline-entries';

interface IndexProps {
  entries: TimelineEntry[];
}

const Index = ({ entries }: IndexProps) => {
  return (
    <div>
      <Head>
        <title>Timeline</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Container maxWidth="md">
        <Paper sx={{ minHeight: '100vh' }}>
          <Typography variant="h2" component="h1" textAlign="center" py={4}>
            Timeline
          </Typography>
          <Divider />
          <TimelineEntries entries={entries} />
        </Paper>
      </Container>
    </div>
  );
};

export const getStaticProps: GetStaticProps = async () => {
  const res = await fetch(`http://localhost:3000/api/timeline-entries`);

  const entries: TimelineEntry[] = await res.json();

  if (!entries) {
    return {
      notFound: true,
    };
  }

  return {
    props: { entries },
  };
};

export default Index;
